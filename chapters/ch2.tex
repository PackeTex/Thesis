%\lecture{1}{Sat 10 Jul 2021 17:50}{The Combinatorial Nullstellensatz} Theorem
%and proofs from CH 22 of Grynkiewicz Structural Additive theory %
\todo{Capitalize Combinatorial Nullstellensatz and remove verbosity in places
where equations can be referenced by index instead of linguistically}
\todo{Unify any competing notation and Put large sums/products into
display/equation mode}
\chapter{Combinatorial Nullstellensatz} We begin by
examining the primary theorem of this investigation, the Combinatorial
Nullstellensatz. This theorem, a powerful generalization of the fundamental
theorem of algebra, builds on Hilbert's Nullstellensatz. In fact, so powerful
is this theorem that it will serve as the central tool in proofs from graph
theory, additive combinatorics, and many other branches of math. To begin, let
us indulge a bit of notation: \begin{notation}[Coefficient of a polynomial] For
	a polynomial\\ $f(x_1, x_2, \ldots, x_{n}) \in R[x_1,x_2, \ldots,
	x_{n}]$ let us define the coefficient of the monomial term
	$x_1^{k_1}x_2^{k_2}\ldots x_{n}^{k_n}$ to be $[x_1^{k_1}x_2^{k_2}\ldots
	x_{n}^{k_n}]f\left( x_1,x_2,\ldots x_{n} \right) $. Hence, we have \[ f(x_1, x_2, \ldots, x_{n}) = \sum_{k_1, k_2, \ldots, k_n \in
			\N_0}^{}\left( [x_1^{k_1}x_2^{k_2}\ldots
		x_{n}^{k_n}]f\left( x_1,x_2,\ldots x_{n} \right)\right)
		x_1^{k_1}x_2^{k_2}\ldots x_{n}^{k_n}   .\]
		\end{notation} Let us also define the following notation for a
		polynomial of $n$ variables : \begin{notation}[Polynomial of n
			variables] For simplicity, let us denote\\ $f\left(
		x_1, x_2, \ldots, x_{n} \right) = f\left( \textbf{x} \right) $
	where it would not introduce unnecessary ambiguity.  \end{notation} Let
	us define one more notation, the degree of a polynomial projected onto
	a single variable $x_{j}$ : \begin{notation}[Degree of projected
		polynomial] Let $\deg_{x_{j}} f \left( \textbf{x} \right)$
		refer to the degree of $f\left( a_1, a_2, \ldots, x_{j},
		\ldots, a_n \right) $. That is, the degree of $f$ in a single variable, $x_{j}$.  \end{notation}
		\newpage With this bookkeeping out of the way let us now
		introduce the primary theorem, the Combinatorial
		Nullstellensatz: \begin{theorem}[Generalized Combinatorial
			Nullstellensatz] Let $R$ be an integral domain, and let
			$A_1, A_2, \ldots, A_n \subseteq R$ be finite and
			nonempty. Let $f\left( \textbf{x} \right) \in R[x_1,
			x_2, \ldots, x_{n}]$ be a polynomial and define\\ $g_i
			\left( x_{i} \right) = \prod_{a \in A_i}^{} \left( x_i
			-a \right) \in R[x_{i}] $ for $1 \le i \le n$. Then, we
			have that $f\left( a_1, a_2, \ldots, a_n \right) = 0$
			for all  $ \textbf{a} \in \prod_{i= 1}^{n} A_i $ if and only if
			there are polynomials \\$h_1\left( \textbf{x} \right) ,
			h_2 \left( \textbf{x} \right) , \ldots, h_n \left(
			\textbf{x} \right)  \in R[x_1, x_2, \ldots, x_{n}]$
			such that \\$f\left( \textbf{x} \right) = \sum_{i=
			1}^{n} g_i \left( x_{i} \right) h_i \left( \textbf{x}
		\right) $ with $ \deg g_i + \deg h_i \le \deg f$ for each $1
		\le i \le n$ and $\deg _{x_{j}} g_i \left( x_{i} \right)  +
		\deg _{x_{j}} h_i \le \deg_{x_{j}} f$ for all $1 \le i,j \le
		n$.  \end{theorem} In order to prove this powerful theorem let
		us first state and prove the following lemma: \begin{lemma}[]
			Let $R$ be an integral domain, $f\left( \textbf{x}
			\right) \in R[x_1, x_2, \ldots, x_{n}]$, and $A_1, A_2,
			\ldots, A_n \subseteq R$ be finite and nonempty.
			Suppose $\deg _{x_{i}} f < \left| A_i \right| $ for
			each $1\le i\le n$ and $f\left( a_1, a_2, \ldots, a_n
			\right) = 0$ for all $ \textbf{a} \in \prod_{i= 1}^{n}
			A_i$. Then $f$ is the zero polynomial.  \end{lemma}
			\begin{proof}[Proof] Let  $F$ be the quotient field of
				$R$. Clearly, any polynomial in $R$ is a
				polynomial in $F$ and as $f=0$ in $F$ implies
				$f=0$ in $R$ we may only consider the case
				$F=R$. We will induce on n. For the case $n=1$
				this is a simple corollary of the fundamental
				theorem of algebra, hence we will omit the
				proof. Now, under the assumption that the case
				$n-1$ is true, let us prove the case $n$.
				First, let us define  $f_i \left( x_1, x_2,
				\ldots, x_{n-1} \right) $ to be the polynomial
				such that \[f\left( \textbf{x} \right)  =
				\sum_{i=0}^{\deg _{x_{n}} f} f_i \left( x_1,
			x_2, \ldots, x_{n-1} \right)  x_n ^{i}.\]  We
			see each $f_i \in F[x_1, x_2, \ldots, x_{n-1}]$
				and $\deg_{x_{j}} f_i \le \deg _{x_{j}} f \le
				\left| A_i \right| $ for all $1 \le j \le n-1$
				and $0 \le i \le \deg _{x_{n}} f$. Let $a_i \in
				A_i$ for each such $i$ be an arbitrary element.
				As $f\left( a_1, a_2, \ldots, a_{n-1}, a
				\right) = 0$ for all $a \in A_n$ and $\deg
				_{x_{n}} f < \left| A_n \right| $, the $n=1$
				case implies that $f\left( a_1, a_2, \ldots,
				a_{n-1}, x_{n} \right) = 0$ must be the zero
				polynomial, hence $f_i \left( a_1, \ldots,
				a_{n-1} \right) =0$ for each $i$ and $
				\left( a_1, \ldots, a_{n-1} \right)  \in \prod_{i= 1}^{n-1} A_i$. Hence, by
			the inductive hypothesis ($n-1$ case) we must have that
		each $f_i$ is the zero polynomial, and hence $f$ is the zero
	polynomial.  \end{proof} This lemma comprises the majority of the
	intellectual heavy lifting for our main theorem and hence its proof
	will appear very simple in comparison to its powerful statement:
	\newpage
	\begin{proof}[Proof of Generalized Combinatorial Nullstellensatz \cite{grynkiewicz_2013}] First, examining the backwards implication, it is
		clear that any polynomial of the form in the theorem (one that
		splits on $x_{i}$ for each $i $ into a polynomial which is
		implicitly zero on the whole of the product) will be zero on
		the whole of $\prod_{i= 1}^{n} A_i $. Now, let us examine the
		converse (the forwards implication). First, let $f\left( \textbf{x} \right) \in R[x_1,
		x_2, \ldots, x_{n}]$ be a polynomial which is zero on the whole
		of such a product. We want to show that such a polynomial
		$h_i$ exists for each $i$.  For each $1\le j \le n$ let us
		define \begin{equation} g_j \left( x_j \right) = \prod_{a \in
	A_j}^{} \left( x_j - a \right) = x_{j}^{\left| A_j \right|} -
	\sum_{i=0}^{\left| A_j -1 \right| } g_{ji} x_j ^{ i} ,\end{equation}
	where each $g_{ji} \in R$ as well. Hence, as $a_j \in A_j$ implies that
$g_j\left( a_j \right) = 0$ we must have that $a_j ^{ \left| A_j \right| } =
\sum_{i=0}^{\left| A_j -1 \right| } g_{ij} a_j ^{ i}$. Now, define
$\overline{f}$ to be the polynomial for which we repeatedly apply this
substitution for each $j$ to the polynomial $f$. We see that $\deg _{x_{i}}
\left( \overline{f} \right) < \left| A_i \right| $ for each $i$(as any monomial term of such degree can be substituted for terms of lesser degree), and as
$\overline{f}\left( \textbf{a} \right)  = f\left( \textbf{a} \right) = 0$ for
each $ \textbf{a}\in \prod_{i= 1}^{n} A_i$ (This fact is trivial by the
construction of $f$ and $\overline{f}$ ), then by the preceding lemma we must
have that $\overline{f} = 0$.  Next, consider the polynomial $f\left(
\textbf{x} \right)  - \overline{f} \left( \textbf{x} \right) $. Define $f_0 =
f$ and $f_i$ to be $f$ after the $i $'th such substitution. Furthermore, let $N \in \N$ be such that  $f_N =
\overline{f}$. Then, the polynomial $f_i$ is obtained by examining a term of
$f_{i-1}$ with a degree in $x_{j}$ of atleast $\left| A_j \right| $ and
replacing an individual factor of $x_{j} ^{ \left| A_j \right| }$ by the sum as
we defined earlier. For simplicity let us take the term
$cx_1^{k_1}x_2^{k_2}\ldots x_{n}^{k_n} \cdot x_{j} ^{\left| A_j \right| }$
(where $k_j \ge 0$ by our construction) and apply such a substitution. Then, we
see that the difference \[f_{i-1} - f_i = cx_1^{k_1}x_2^{k_2}\ldots x_{n}^{
k_n} \left(x_{j}^{\left| A_j \right|}  - \sum_{i=0}^{\left| A_j \right| -1}
g_{ji} x_j ^{i}\right) = cx_1^{k_1}x_2^{k_2}\ldots x_{n}^{k_n} \cdot g_j
\left( x_j \right)\] by our original definition. Furthermore, as $f_N =
\overline{f}$ we have that \[ f - \overline{f} = \left( f_0 - f_1 \right) +
\left( f_1 - f_2 \right) + \ldots + \left( f_{N-1} - f_N \right) .\] Hence, as
$f = f - 0 = f - \overline{f} = \sum_{j=1}^{n} g_j \left( x_{j} \right) h_j$
where each $h_j \in R[x_1, x_2, \ldots, x_{n}]$ is simply the sum of all of
these preceding terms $cx_1^{k_1}\ldots x_{n}^{ k_n}$ as a result of these
substitutions. \\Furthermore, by construction we had that $\deg g_j = \left| A_{j} \right| > \deg
\left( \sum_{i=0}^{\left| A_j \right| -1} g_{ji} x_{j}^{i} \right) $, so we see
that such a substitution will never increase the degree of our polynomial and
hence $\deg f_i \le \deg f$. Then, as $\deg g_j = \left| A_j \right| $ we see
that \[\deg\left( cx_1^{k_1}\ldots x_{n}^{k_n}g_j(x_j) \right) \le \deg
f_{i-1} \le \deg f.\] Using the additive nature of polynomial degree yields
\\$\deg \left( cx_1^{k_1}\ldots x_{n}^{ k_n} \right) + \deg g_j \le \deg f$,
and as each $h_j$ is simply the sum of such terms we may substitute its degree
to yield $\deg g_j + \deg h_j \le \deg f$.  Applying the same argument but with
the projected degree of $g$ and $f $ yields \\$\deg _{x_i} g_j + \deg _{x_i}
h_j \le \deg _{x_i} f$ for all $i,j$. Hence the converse is true and this
completes the proof.  \end{proof} This theorem is perhaps too general and too
powerful for use in proving our simpler results. As a corollary, many authors
include a sort of "Combinatorial Nullstellensatz 2" wherein the splitting of a
polynomial with certain requirements on degree is replaced by the existence of
a member of the product $\prod_{i= 1}^{n} A_i $ for which $f$ is nonzero. This
is the statement that we will declare as the Combinatorial Nullstellensatz and
which will be used in the proof of all subsequent results which permit the use of such a theorem:
\begin{theorem}[Combinatorial Nullstellensatz] Let
	$R$ be an integral domain, $A_1, A_2, \ldots, A_n \subseteq R$ be
	finite and nonempty, and \\$f\left( \textbf{x} \right) \in R[x_1, x_2,
	\ldots, x_{n}]$ be a polynomial. Suppose \[ [x_1^{d_1}x_2^{d_2}\ldots
	x_{n}^{d_n}] f\left( \textbf{x} \right) \neq 0 \] and that $\deg f =
	\sum_{i=1}^{n} d_i$ with $0 \le d_i \le \left| A_i \right| -1$. Then,
	there exists an element $ \textbf{a} \in \prod_{i= 1}^{n} A_i $ such
	that $f\left( \textbf{a} \right) \neq 0$. That is, given a nontrivial
	"maximal degree" monomial of $f$ such that the degree of this monomial
	in each variable individually is strictly less than the size of the
	corresponding set $A_i$, $f$ cannot be zero on the whole of the product
	of the $A_i$.  \end{theorem} This is the generalization of the
	Fundamental theorem of Algebra to which we referred earlier and it is
	precisely this simple statement about the size of the kernel of a
	particular polynomial which provides our combinatorial power. The proof
	follows rather directly from the negation of the generalized version and it is
	as follows: \begin{proof}[Proof] Let $g_i = \prod_{a \in A_i}^{} \left(
		x_{i} - a \right) $ for $1 \le i \le n$ and suppose the
		contrary. That is, $f\left( \textbf{a} \right) = 0$ for all $
		\textbf{a} \in \prod_{i= 1}^{n} A_i $ despite the assumptions of the construction. Then, applying the
		generalized combinatorial nullstellensatz yields polynomials
		$h_1, h_2, \ldots, h_n \in R[x_1, x_2, \ldots, x_{n}]$ with the
		desired properties. Now let us examine the nature of
		$[x_1^{d_1}\ldots x_{n}^{ d_n}] f\left( \textbf{x} \right) $.
		As this is a maximal degree monomial of $f$, then only maximal
		degree monomials of $h_i \left( \textbf{x} \right)  g_i \left(
		x_i \right) $ can contribute to its coefficient in $f$ as $\deg \left( h_{i} \right) + \deg \left( g_{i} \right) = \deg
		h_i g_i \le \deg f$. However, by the construction of $g_i$, all
		such monomials will be taken from the $h_i \left( \textbf{x}
		\right) \cdot x_i ^{ \left| A_i \right| } $ portion of this
		polynomial. Thus $\deg _{x_{i}} h_i g_i> d_i$ by our
		requirement that each  $d_i < \left| A_i \right| $, hence all
	maximal degree monomials of $f$ must be of the form
$x_1^{k_1}x_2^{k_2}\ldots x_{j}^{\left| A_j \right|} \ldots x_{n}^{ k_n}$.
Thus, we must have $[x_1^{d_1}x_2^{d_2}\ldots x_{n}^{d_n}] f\left( \textbf{x}
\right) = 0$, $\lightning$. Hence, there must be an $ \textbf{a} \in \prod_{i=
1}^{n} A_i $ such that $f\left( \textbf{a} \right) \neq 0$.  \end{proof} Our
last version of the Combinatorial Nullstellensatz will examine what happens
when $f$ vanishes over not all, but most (in a certain set-theoretic
perspective) of the members of the product. This is known as the Punctured
Combinatorial Nullstellensatz and it builds on the original generalized
version. The proof will involve division of polynomials of many variables, so
let us first examine the nature of such an operation.
\begin{lemma}[Multivariate Polynomial Division] Let $R$ be an integral domain
	and let $g_{1} \left( x_{1} \right), \ldots, g_{k} \left( x_{k} \right)
	\in R[x_1, x_2, \ldots, x_{n}] $ be polynomials of one variable with
	leading coefficient $1$ for $1 \le k \le n$. Multivariate polynomial
	division is well behaved if one of the following holds:\\ $1$: $f
	\left(  \textbf{x} \right) \in \sum_{i= 1}^{k}  R[x_1, x_2, \ldots,
	x_{n}] \cdot g_{i} \left( x_{i} \right)$ is nonzero implies that there
	is a $1 \le i \le k$ such that $\deg _{x_{i}} \left(  f \right) \ge
	\deg \left( g_{i} \right)$.\\ \\ $2$: For a polynomial $f \in R [x_1,
	x_2, \ldots, x_{n}]$ there are functions \\$w \left( \textbf{x} \right)
	, h_1, \left( \textbf{x} \right), \ldots, h_k \left( \textbf{x} \right)
	$ such that all of the following hold:\\ \begin{equation} f\left(
	\textbf{x} \right) = \sum_{i= 1}^{k} h_{i} \left( \textbf{x} \right)
g_{i} \left( x_{i} \right)  + w\left( \textbf{x} \right) ,\end{equation} $\deg
_{ x_j} \left( w \right) < \deg _{} \left( g_{j} \right) $ for $ 1\le j \le k$,
\\$\deg _{ x_j} \left( g_{i} \left( x_{i} \right) \right) + \deg _{ x_j} \left(
h_{i} \right) \le \deg _{ x_j} \left( f \right)$, $\deg \left( g_{i} \right) +
\deg \left( h_{i} \right) \le \deg \left(  f \right)$ for $1 \le i \le k, 1 \le
j\le n$, \\ $\deg _{x_{i}} \left( w \right) \le \deg _{ x_{i}} \left(  f
\right) $ for $1 \le i \le n$, and \\ $\deg \left( w \right)\le \deg \left( f
\right)$.\\ Furthermore, the polynomial $w\left( \textbf{x} \right) $ is unique
provided it satisfies the first condition of ($2$). Lastly, a simple
substitution allows us to assume these cases to be mutually exclusive for the
purposes of the proof of the punctured Combinatorial Nullstellensatz.
\end{lemma} The proof of this lemma is ommitted (for now). \todo{include proof of lemma}
\begin{theorem}[Punctured Combinatorial Nullstellensatz] Let $R$ be an integral
	domain and let $A_1, A_2, \ldots, A_{n} \subset R$ be finite and
	nonempty. Furthermore, for each $1\le i \le n$ let $ B_{i} \subseteq
	A_{i}$ be nonempty.\\ Let $f\left( \textbf{x} \right) \in R[x_1, x_2,
	\ldots, x_{n}]$ be a polynomial and set $g_{i}\left( x_{i} \right) =
	\prod_{a \in A_{i}}^{}\left( x_{i}-a \right)$ and $l_{i}\left( x_{i}
	\right) = \prod_{b \in B_{i}}^{} \left( x_{i}-b \right) $. If
	\begin{equation} f\left( \textbf{a} \right) = 0 \ \forall \
		\textbf{a}\in\left( \prod_{i=1}^{n} A_{i} \right)
		\setminus\left( \prod_{i=1}^{n} B_{i} \right) \end{equation}
		but there exists a $\textbf{b} \in \prod_{i=1}^{n} B_{i}$ such
		that $f\left( \textbf{b} \right) \neq 0 $ then there are
		polynomial $h_{i} \in R[x_1, x_2, \ldots, x_{n}]$ with $1 \le i
		\le n$ such that \[ f\left( \textbf{x} \right) = \sum_{i=
			1}^{n} g_{i} \left( x_{i} \right) h_{i} \left(
		\textbf{x} \right)  + w\left( \textbf{x} \right) \text{ with }
		w\left( \textbf{x} \right) = u\left( \textbf{x} \right)
		\prod_{i=1}^{n} \frac{g_{i}\left( {x}_{i} \right) }{l_{i}
		\left( x_{i} \right) } .\]  with the following conditions
		holding: \newline $\deg \left( w \right) \le \deg \left( f
		\right) \deg _{ x_j} \left( w \right) \le \deg _{ x_j} \left(
	f \right) $ for all $1 \le j \le n$, $\deg _{x_{i}} \left( w \right)  <
	\left| A_{i} \right| $, $\deg \left( g_{i} \right) + \deg \left( h_{i}
	\right)\le \deg \left( f \right)$ for $1 \le i \le n$ and\\	 $\deg
	_{ x_j} \left( g_{i} \left( x_{i} \right)  \right) + \deg _{ x_j}
	\left( h_{i} \right) \le \deg _{ x_j} \left(  f \right) $ for $1 \le
	i,j \le n$. Consequently $\sum_{i= 1}^{n} \left( \left|  A_{i} \right|
	- \left| B_{i} \right|  \right)  \le \deg \left(  w \right) \le \deg
	\left(  f \right)$.  \end{theorem} \begin{proof}[Proof] The preceding
	lemma guarantees there to be polynomials \[w\left( \textbf{x} \right) ,
	h_1 \left( \textbf{x} \right) , \ldots, h_{n} \left( \textbf{x} \right)
\in R[x_1, x_2, \ldots, x_{n}]\] of the desired form and for which the
	proper conditions hold (case $2$). Our task, then, is to ensure that
	the form of $w\left( \textbf{x} \right)$ is that of our statement.
	First, let $1 \le i \le n$ and without loss of generality select $i
	=1$. First, we consider $w\left( \textbf{x} \right) l_1\left( x_1
	\right) $. Then as $f$ and the first sum of equation (2) must be zero
	on all $\textbf{a}\in \prod_{i= 1}^{n} A_{i} \setminus \prod_{i= 1}^{n}
	B_{i}$, we see $w\left( \textbf{x} \right) $ must also vanish on this
	difference of products. Furthermore, by the construction of $l_1$ we
	must have that $w\left( \textbf{x} \right) l_1 \left( x_1 \right) $
	vanishes on $\prod_{i= 1}^{n} B_{i}$ as well, hence it vanishes on all
	of $\prod_{i= 1}^{n} A_{i}$. Applying theorem 1 (Generalized
	Combinatorial Nullstellensatz) yields polynomials $v_1, \ldots, v_{n}
	\in R[x_1, \ldots, x_{n}]$ such that \begin{equation} w\left(
		\textbf{x} \right) l_1 \left( x_1 \right) = \sum_{i= 1}^{n}
		g_{i} \left( x_{i} \right) v_{i} \left( \textbf{x} \right)
		.\end{equation} Now, by the preceding lemma we may assume that
		$v_{j} \left( \textbf{x} \right) $ is not of the form in case
		1. Furthermore, for $n>1$, we see $\deg _{x_{n}} \left( w
		\left( \textbf{x} \right) l_{i} \left( x_{i} \right)  \right) >
		\left| A_{n} \right| $ as a consequence of the stipulations of
		$w\left( \textbf{x} \right) $. Now, for a polynomial $h \in
		f[x_1, ..., x_{n}]$ define $\overline{h}$ to be $h$ reduced
		modulo the ideal generated by $g_1 \left( x_1 \right) , \ldots,
		g_{n-1}\left( x_{n-1} \right) $. Applying this operation to
		equation (4) yields  \[ \overline{w\left( \textbf{x} \right)
		l_{1} \left( x_1 \right) } = \overline{g_{n}\left( x_{n}
\right) v_{n} \left( \textbf{x} \right) } .\] \todo{Finish Proof of Punctured
Nullstellensatz} \end{proof} With all three variations of the Combinatorial
Nullstellensatz fully stated and proven, allow us to move on to the examination
of some of the most powerful results which these theorems prove, namely in
combinatorics. We will begin with a proof of the Chevalley-Warning theorem as
well as several results of additive combinatorics concerning sumsets, both
standard and restricted.  \todo{Maybe change proof to the one found in Simeon
and Ball instead of Grynkiewicz if it is less notationally dense}
